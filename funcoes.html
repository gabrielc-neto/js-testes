<!DOCTYPE html>
<html lang="pt-br">
 <head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Doc</title>
  <style>
  </style>
 </head>
 <body>
  <nav id="navbar">
   <a href="" class="nav-brand">App</a>
   <ul>
    <li class="nav-item"><a href="about.html">Sobre</a></li>
    <li><a href="" class="nav-item btn btn-default">Registrar</a></li>
   </ul>
  </nav>

  <div class="container" id="main">
    <h1>Bem vindo ao nosso app</h1>
    <p>
      Lorem ipsum dolor sit amet consectetur, adipisicing elit. Natus,
      voluptatem.
    </p>

    <form id="form-dos-afazeres">
      <label for="titulo-dos-afazeres">Afazeres</label>
      <input id="titulo-dos-afazeres" type="text" placeholder="Entre com o seu afazer">
      <select id="categoria-de-afazeres">
        <option value="trabalho">Trabalho</option>
        <option value="pessoal">Pessoal</option>
      </select>
      <input type="submit" class="btn btn-outline" value="Adicionar" />
    </form>
    <hr class="separator" />
    <div>
      <label>
        Filtro:
        <select id="filtro-do-afazeres">
          <option value="">Mostre tudo</option>
          <option value="trabalho">Apenas o trabalho</option>
          <option value="pessoal">Apenas o pessoal</option>
        </select>
      </label>
      <h3>Todos <span id="contagem-de-afazeres"></span></h3>
      <ul id="lista-de-afazeres"></ul>
    </div>
  </div>

  <footer id="footer-wrapper">
    <a href="about.html" target="_blank">Sobre</a>
    <a href="contact.html" target="_blank">Contato</a>
  </footer>
  <script>
    class Todos {
    constructor() {
        this.afazeres = [{
            titulo: "Curso de JavaScript",
            categoria: "trabalho"
        }, {
            titulo: "Meditação",
            categoria: "pessoal"
        }];
    }

    obterTudo() {
        // This method is already correct, it returns the full array.
        return this.afazeres;
    }

    obterContagem() {
        // This method is already correct, it returns the length of the array.
        return this.afazeres.length;
    }

    adicionar(titulo, categoria) {
        // This method is already correct, it adds a new object to the array.
        // It's good practice to wrap the new item in an object like you did.
        return this.afazeres.push({
            titulo: titulo,
            categoria: categoria
        });
    }

    obterTrabalho() {
        // Use filter() to get all tasks of the "trabalho" category.
        return this.afazeres.filter(tarefa => tarefa.categoria === "trabalho");
    }

    obterContagemDeTrabalho() {
        // Get the length of the array returned by obterTrabalho().
        // This is a common and efficient pattern.
        return this.obterTrabalho().length;
    }

    obterPessoal() {
        // Use filter() to get all tasks of the "pessoal" category.
        return this.afazeres.filter(tarefa => tarefa.categoria === "pessoal");
    }

    obterContagemPessoal() {
        // This method is already correct. It uses obterPessoal() and its length.
        return this.obterPessoal().length;
    }
}
        
    const form = document.querySelector("#form-dos-afazeres");
    const titulo = document.querySelector("#titulo-dos-afazeres");
    const categoria = document.querySelector("#categoria-de-afazeres");
    const lista = document.querySelector("#lista-de-afazeres");
    const filtro = document.querySelector("#filtro-do-afazeres");
    const contagem = document.querySelector("#contagem-de-afazeres");

    const render = (itens, contagemDeItens) => {
      contagem.textContent = `(${contagemDeItens})`;
      lista.innerHTML = itens.map(todo => `<li>${todo.titulo} [${todo.categoria}]</li>`).join("");
    }

    const afazeres = new Todos();

    try {
      render(afazeres.obterTudo(), afazeres.obterContagem());
    } catch (error) {
      console.error(error);
    }

    form.addEventListener("submit", event => {
      event.preventDefault();
      try {
        afazeres.adicionar(titulo.value, categoria.value);
        render(afazeres.obterTudo(), afazeres.obterContagem());
      } catch (error) {
        console.error(error);
      }
      titulo.value = "";
    });

    filtro.addEventListener("change", () => {
      try {
        if (filtro.value === "trabalho") {
          // filtro trabalho
          render(afazeres.obterTrabalho(), afazeres.obterContagemDeTrabalho());
        } else if (filtro.value === "pessoal") {
          // filtro pessoal
          render(afazeres.obterPessoal(), afazeres.obterContagemPessoal());
        } else {
          // mostrar tudo
          render(afazeres.obterTudo(), afazeres.obterContagem());
        }
      } catch (error) {
        console.error(error);
      }
    });

  </script>
 </body>
</html>
